{% extends "base.html" %}
{% block content %}
<main role="main">
    <br>
    <div class="container">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                {% if request.user.is_authenticated %}
                <a id="button" class="btn btn-success" style="width:100%; margin-bottom:10px;"
                    href="{{ url_for('question_create') }}"><i class="fa fa-plus" aria-hidden="true"></i> Ask
                    Questions</a>
                {% else %}
                <a id="button" class="btn btn-success" style="width:100%; margin-bottom:10px;"
                    href="{{ url_for('login') }}?next={{ path }}?page={{ page_query }}"><i class="fa fa-plus"
                        aria-hidden="true"></i> Ask
                    Questions</a>
                {% endif %}
                <form method='GET' action="{{ url_for('search') }}?page={{ page_query }}?q={{ q }}">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fa fa-search" aria-hidden="true"></i></span>
                        </div>
                        <input type="text" class="form-control" name="q" placeholder="Search questions">
                    </div>
                </form>
                <hr>
                {% if results %}
                {% for item in results %}
                <h4><b><a href="{{ url_for('question', id=item.id, slug=item.slug) }}">{{ item.title }}</a></b>
                    <small class="float-right">Asked on <i>{{ item.created.strftime('%d-%m-%Y %H:%M:%S') }}</i> by
                        <b>{{ item.user.username }}</b><b>
                        </b></small></h4>
                <hr>
                <p class="mb-1">{{ item.content }}</p><br>
                <i class="fa fa-eye" aria-hidden="true" title="Views"> {{ item.view }}</i>&ensp;
                <i class="fa fa-comment" aria-hidden="true" title="Answers"> {{ item.answer_count }}</i>&ensp;
                <i class="fa fa-thumbs-up" aria-hidden="true" title="Likes"> {{ item.question_like }}</i>&ensp;
                <br><br>
                {% for tag in item.tags %}
                <a href="{{ url_for('tags', tag=tag.name) }}" class="btn btn-xs btn-primary">{{ tag.name }}</a>
                {% endfor %}

                <hr>
                {% endfor %}
                {% else %}
                <h4>No questions</h4>
                {% endif %}
                <ul id="questions" class="pagination-sm float-right"></ul>  
            </div>
        </div>
    </div>
    <hr>
    </div> <!-- /container -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="{{ url_for('static', path='/js/jquery.twbsPagination.js') }}"></script>
    <script type="text/javascript">
        $('#questions').twbsPagination({
            totalPages: {{ totalPages }},
            visiblePages: 4,
            startPage: 1,
            pageVariable: 'page',
            href: true,
            defaultHref: '/questions?page=',
        });
    </script>
</main>
{% endblock %}